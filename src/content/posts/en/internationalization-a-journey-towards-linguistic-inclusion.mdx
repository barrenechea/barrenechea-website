---
title: "Internationalization: A Journey Towards Linguistic Inclusion"
description: My site leaps into internationalization, breaking down language barriers to embrace a diverse audience.
pubDate: 2023-12-27T12:00:00Z
img: ~/assets/images/post-i18n.jpg
imgAlt: "Image generated by Firefly Image 2 with the text: award winning art, a branched tree made of light rays and energy, dramatic, impactful, colorful, high definition, 4k uhd"
translatedBy: gpt-4-1106-preview
checksum: fa5801f11cb3dac21895569d7b6bb87b1866af96243b77264fe43a2f42c5c008
---

import OldNavbar from "~/assets/images/post-i18n-old-navbar.png";
import NewNavbar from "~/assets/images/post-i18n-new-navbar.png";
import WrongEsTranslation from "~/assets/images/post-i18n-wrong-es-translation.png";
import { Image } from "astro:assets";

From the inception of this page, I chose to use English as the primary language, assuming it was the most prevalent on the internet. However, I recently heard that among Meta and X networks, the second most used language is Spanish. Personally, I had a pending debt to showcase my content in my mother tongue, and today that is a reality.

In recent days, I've internationalized every corner of the site, assigning key/value format values for the interface, and translating the content of projects and publications automatically using LLMs (Large Language Models).

## Where do I start, my friend?

There are two main aspects to consider: the user interface and the content.

The [documentation](https://docs.astro.build/en/recipes/i18n/) from Astro and its [source code](https://github.com/withastro/docs/tree/main/src/i18n) were quite helpful with the base logic, however, I made several adjustments to adapt it to my needs and keep the code as clean as possible.

This site focuses mainly on the content of the publications and, in terms of interface, it is quite simple. The largest amount of static text was on the homepage, so I started extracting each value into key/value objects, allowing the view to render the same way.

```typescript
export const en = {
  "author.name": "Sebastian Barrenechea",

  "nav.fork": "Fork me on GitHub",
  "nav.sr.open": "Open navigation menu",
  "nav.home": "Home",
  "nav.projects": "Projects",
  "nav.posts": "Posts",
  "nav.page": "Page",
  "nav.language.select": "Select language",

  "hero.greeting": "Heey! I'm",
  // ...
};
```

Route handling is crucial for identifying the pages to build. Astro makes this easy with its routing system, allowing the language to be available as a parameter:

- Move all pages within the `src/pages` directory to a `src/pages/[lang]` directory
- Add something like this on each of the pages that require i18n handling:
  ```typescript
  const { lang } = Astro.params;
  ```

With the English version working, I started adding Spanish support. Here I encountered a translation dilemma:

<Image
  src={WrongEsTranslation}
  alt="Screenshot of the homepage with Spanish texts 'Últimos Publicaciones' and 'Ver todos los publicaciones', incorrectly translated"
  format="webp"
/>

In English, I could use the same values for both projects and publications, but in Spanish, I could not.

In an ideal world, I would use gender-neutral language. I could have opted for "Proyectos recientes" and "Publicaciones recientes," which would allow me to recycle the word. However, to maintain the visual consistency of the page, I needed the phrase to end in "proyectos" or "publicaciones." After some adjustments, I managed to have it fully translated in all views (the index, navigation pages, and templates that use the content).

And there was a problem with the language selection component I had used that bothered me a lot. The component required the `absolute` class to position objects below it, which caused it to stop respecting the page margin in case of very long text:

<div align="center">
  <Image
    src={OldNavbar}
    alt="Screenshot of the previous navigation bar, with the language selector in the top right corner exceeding the margin limit"
    format="webp"
  />
  <p class="italic">Margin outlined in red to highlight the problem</p>
</div>

I extracted that component from [Starlight](https://starlight.astro.build/) since it seemed simple and minimalist, but in the end, I replaced it with one from [Flowbite](https://flowbite.com/docs/components/navbar/#language-dropdown) reimplementing interactivity using the [Web Components API](https://web.dev/articles/custom-elements-v1). The new component requires an additional graphic for each language (the flag, using [@iconify-icons/circle-flags](https://icon-sets.iconify.design/circle-flags/)), but it's worth it.

<Image
  src={NewNavbar}
  alt="Screenshot of the current navigation bar, with the language selector in the top right corner"
  format="webp"
/>

## But there's no content to be seen, huh?

When adjusting the site content (projects and publications) to their corresponding English route, the site could not find the content in Spanish, resulting in a page without navigable content. The first tests I did were manually translating with the OpenAI API, and then I automated the process to make things easier.

_You can see more details in an upcoming post about the use of LLMs in production._

After finishing the translation of projects and publications into Spanish, I made some adjustments to the resulting translations. I set Spanish as the reference standard for the automated translation process and, after the necessary adjustments, regenerated the content in English.

## What now?

Now it's surprisingly simple to add support for more languages! There are certain considerations to keep in mind, such as "assuming" that the language is read from left to right, which excludes languages like Arabic or Hebrew. Tailwind, the CSS framework I use on this site, natively supports LTR (left to right) and RTL (right to left), but some details need to be adjusted (for example, using the `rtl:space-x-reverse` class where necessary).

I have effortlessly incorporated support for the German language and have short-term plans to add Italian, French, Traditional Chinese, and Icelandic (I♥️Iceland). Although automation makes the process easier, it is essential to review the translations to ensure their quality, as they are not always perfect. In the case of English, I was able to do a personal review; however, for languages like German, which I do not master, I have resorted to the help of tools like Google Chrome's automatic translation to verify consistency. My goal is to eventually collaborate with native speakers for each language to raise the standard of the translations offered.
