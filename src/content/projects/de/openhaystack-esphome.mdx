---
title: OpenHaystack in ESPHome
description: Portierung von OpenHaystack als eine Komponente für ESPHome. Kompatibel mit allen Espressif-Geräten mit BLE.
pubDate: 2022-06-23T10:42:00Z
link: https://github.com/barrenechea/esphome-config-files/tree/main/components/openhaystack
img: ~/assets/images/project-openhaystack.png
imgAlt: Logos von OpenHaystack und ESPHome
tags:
  - Hardware
  - Embedded
translatedBy: gpt-4-1106-preview
originSha: e487dcdeda89df21fb06697b62dee63ab160b4b80d47a17539937808339181ab
---

[OpenHaystack](https://github.com/seemoo-lab/openhaystack) ist eine Anwendung, die es Ihnen ermöglicht, Ihre eigenen Zubehörteile zu erstellen, die vom [Find My network](https://developer.apple.com/find-my/) von Apple verfolgt werden können. Sie haben das Protokoll von Apple reverse-engineered und dokumentiert, ein ziemlich beeindruckendes Projekt.

Ich wollte meinen Elektroroller verfolgen können, falls er gestohlen würde. Obwohl die "offizielle" Methode zum Erstellen Ihrer Zubehörteile "akzeptabel" war, stellte sie sich als ziemlich problematisch und mit verschiedenen Kompatibilitätsproblemen auf verschiedenen Espressif-Boards heraus.

Also habe ich es als eine Komponente von [ESPHome](https://esphome.io/) portiert, einer Software, die ich bereits für die Bedürfnisse meiner eingebetteten Geräte verwende.

## Warum ESPHome? Ist das nicht "für zu Hause"?

Ich bin _ein wenig_ besessen davon, meine IoT/Embedded-Geräte so aktuell wie möglich zu halten (und natürlich, wenn möglich, außerhalb jeglicher Cloud), also ist ESPHome eine attraktive Lösung, um Ihre Geräte mit den Arduino- und Espressif-Frameworks aktuell zu halten. Mit ESPHome kann ich meinen Roller aktualisieren, wann immer ich will.

## Warum ist dies kein offizieller Bestandteil?

Ich habe es versucht! Ich habe [Add support for OpenHaystack #3584](https://github.com/esphome/esphome/pull/3584) und seine [Support-Dokumentation](https://deploy-preview-2146--esphome.netlify.app/components/openhaystack.html) eröffnet, aber verständlicherweise wollten sie es nicht mischen.

## ESPHome-Beispiel - ESP32

```yaml
external_components:
  - source:
      type: git
      url: https://github.com/barrenechea/esphome-config-files
      ref: main
    components: [openhaystack]

esphome:
  name: openhaystack-demo

esp32:
  board: wemos_d1_mini32

wifi:
  ssid: <dein-wifi-ssid>
  password: <dein-wifi-passwort>

# Logs aktivieren
logger:

# Home Assistant API aktivieren
api:

ota:
  password: !secret ota_password

openhaystack:
  # Hier kommt der in Base64 codierte OpenHaystack-Schlüssel
  # Ich empfehle dringend, ihn als Geheimnis zu behandeln
  key: !secret openhaystack_key
```

## ESPHome-Beispiel - ESP32-C3

```yaml
external_components:
  - source:
      type: git
      url: https://github.com/barrenechea/esphome-config-files
      ref: main
    components: [openhaystack]

esphome:
  name: openhaystack-demo
  platformio_options:
    board_build.flash_mode: dio

esp32:
  board: esp32-c3-devkitm-1
  variant: ESP32C3
  framework:
    type: esp-idf
    version: latest
    sdkconfig_options:
      CONFIG_FREERTOS_UNICORE: y
      CONFIG_COMPILER_OPTIMIZATION_SIZE: y
      # WPA3-Unterstützung aktivieren, nur weil wir können
      CONFIG_WPA_SUITE_B_192: y
      # Spezifisch für die Verwendung von Bluetooth
      CONFIG_BT_BLE_50_FEATURES_SUPPORTED: y
      CONFIG_BT_BLE_42_FEATURES_SUPPORTED: y
      # "Payload size error" korrigieren - Watchdog-Wartezeit verlängern
      CONFIG_ESP_TASK_WDT_TIMEOUT_S: "10"

wifi:
  ssid: <dein-wifi-ssid>
  password: <dein-wifi-passwort>

# Logs aktivieren
logger:

# Home Assistant API aktivieren
api:

ota:
  password: !secret ota_password

openhaystack:
  # Hier kommt der in Base64 codierte OpenHaystack-Schlüssel
  # Ich empfehle dringend, ihn als Geheimnis zu behandeln
  key: !secret openhaystack_key
```
